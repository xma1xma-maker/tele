
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>Clicker Pro V6.4 - Mustafa Alaa</title>
Â  Â  <script src="https://telegram.org/js/telegram-web-app.js"></script>
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --bg-dark: #0a0a0a;
Â  Â  Â  Â  Â  Â  --primary: #0098EA;
Â  Â  Â  Â  Â  Â  --secondary: #f39c12;
Â  Â  Â  Â  Â  Â  --surface: rgba(255, 255, 255, 0.08);
Â  Â  Â  Â  Â  Â  --border: rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  Â  Â  --text-main: #ffffff;
Â  Â  Â  Â  Â  Â  --success: #2ecc71;
Â  Â  Â  Â  Â  Â  --danger: #e74c3c;
Â  Â  Â  Â  }

Â  Â  Â  Â  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Cairo', sans-serif;
Â  Â  Â  Â  Â  Â  background-color: var(--bg-dark);
Â  Â  Â  Â  Â  Â  background-image: radial-gradient(circle at 50% 0%, #1a3a5a, #000);
Â  Â  Â  Â  Â  Â  color: var(--text-main);
Â  Â  Â  Â  Â  Â  margin: 0; min-height: 100vh;
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column;
Â  Â  Â  Â  Â  Â  padding-bottom: 95px;
Â  Â  Â  Â  Â  Â  overflow-x: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- Header --- */
Â  Â  Â  Â  .header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.2); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); z-index: 10; }
Â  Â  Â  Â  .lang-toggle { background: var(--surface); border: 1px solid var(--border); color: #fff; padding: 5px 12px; border-radius: 20px; cursor: pointer; font-weight: bold; display: flex; align-items: center; gap: 5px; font-size: 0.8rem; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Score & Game --- */
Â  Â  Â  Â  .score-container { text-align: center; margin-top: 20px; }
Â  Â  Â  Â  .score-val { font-size: 3.2rem; font-weight: 900; color: #fff; text-shadow: 0 0 20px var(--primary); }
Â  Â  Â  Â  .game-area { flex-grow: 1; display: flex; align-items: center; justify-content: center; position: relative; }
Â  Â  Â  Â  .coin { width: 230px; height: 230px; border-radius: 50%; border: 10px solid rgba(255,255,255,0.1); box-shadow: 0 0 60px rgba(0, 152, 234, 0.4); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: transform 0.1s; background: radial-gradient(circle at 30% 30%, #4facfe, #00f2fe); }
Â  Â  Â  Â  .coin:active { transform: scale(0.9); }

Â  Â  Â  Â  /* --- Modals --- */
Â  Â  Â  Â  .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; display: none; align-items: flex-end; backdrop-filter: blur(8px); }
Â  Â  Â  Â  .modal-overlay.active { display: flex; }
Â  Â  Â  Â  .modal-content { background: #111; width: 100%; border-radius: 30px 30px 0 0; padding: 25px; border-top: 3px solid var(--primary); max-height: 85vh; overflow-y: auto; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Nav Bar (ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„Ø¯Ø¹ÙˆØ© Ù‡Ù†Ø§) --- */
Â  Â  Â  Â  .nav-bar { position: fixed; bottom: 15px; left: 10px; right: 10px; background: rgba(20,20,20,0.95); border-radius: 25px; display: flex; justify-content: space-between; padding: 12px 15px; border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
Â  Â  Â  Â  .nav-btn { display: flex; flex-direction: column; align-items: center; font-size: 0.65rem; color: #777; cursor: pointer; transition: 0.2s; flex: 1; }
Â  Â  Â  Â  .nav-btn.active { color: #fff; transform: translateY(-3px); }

Â  Â  Â  Â  .btn-main { width: 100%; padding: 16px; background: var(--primary); border: none; color: #fff; border-radius: 14px; font-weight: bold; margin-top: 15px; cursor: pointer; }
Â  Â  Â  Â  .inp { width: 100%; padding: 15px; background: #1a1a1a; border: 1px solid #333; color: var(--primary); border-radius: 12px; margin: 15px 0; text-align: center; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #loader { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; }
Â  Â  </style>
</head>
<body>

Â  Â  <div id="loader">
Â  Â  Â  Â  <div style="width: 50px; height: 50px; border: 5px solid #222; border-top-color: var(--primary); border-radius: 50%; animation: spin 1s infinite linear;"></div>
Â  Â  Â  Â  <h3 style="margin-top:20px; color: #fff;">Clicker Pro V6.4</h3>
Â  Â  </div>

Â  Â  <div class="header">
Â  Â  Â  Â  <div class="lang-toggle" onclick="toggleLang()">
Â  Â  Â  Â  Â  Â  <span id="lang-icon">ğŸ‡®ğŸ‡¶</span>
Â  Â  Â  Â  Â  Â  <span id="lang-text">AR</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div style="display: flex; gap: 10px; align-items: center;">
Â  Â  Â  Â  Â  Â  Â <button onclick="openModal('dailyModal')" style="background: gold; border: none; border-radius: 50%; width: 35px; height: 35px; cursor: pointer;">ğŸ</button>
Â  Â  Â  Â  Â  Â  Â <span id="rank-name" style="font-weight:bold; color:var(--secondary); font-size: 0.9rem;">ğŸ¥‰ Bronze</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="user-display-name" style="font-weight:bold; font-size:0.8rem">Player</div>
Â  Â  </div>

Â  Â  <div class="score-container">
Â  Â  Â  Â  <div class="score-val" id="score">0</div>
Â  Â  Â  Â  <div style="color:#666; font-size:0.8rem;" data-key="balance">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
Â  Â  </div>

Â  Â  <div class="game-area" id="game-area">
Â  Â  Â  Â  <div class="coin" id="main-coin" onpointerdown="handleTap(event)">
Â  Â  Â  Â  Â  Â  <svg viewBox="0 0 24 24" width="110" fill="white"><path d="M12 22L1.5 8 12 2l10.5 6L12 22zm0-2.5l8-10-8-5.5-8 5.5 8 10z"/></svg>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="nav-bar">
Â  Â  Â  Â  <div class="nav-btn active" onclick="closeAllModals()">ğŸ  <span data-key="nav_home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
Â  Â  Â  Â  <div class="nav-btn" onclick="openStore()">ğŸ›ï¸ <span data-key="nav_store">Ø§Ù„Ù…ØªØ¬Ø±</span></div>
Â  Â  Â  Â  <div class="nav-btn" onclick="openModal('friendsModal')">ğŸ‘¥ <span data-key="nav_friends">Ø¯Ø¹ÙˆØ©</span></div>
Â  Â  Â  Â  <div class="nav-btn" onclick="openTasks()">ğŸ“‹ <span data-key="nav_tasks">Ù…Ù‡Ø§Ù…</span></div>
Â  Â  Â  Â  <div class="nav-btn" onclick="startQuiz()">ğŸ§  <span data-key="nav_quiz">Ù…Ø³Ø§Ø¨Ù‚Ø©</span></div>
Â  Â  </div>

Â  Â  <div class="modal-overlay" id="friendsModal">
Â  Â  Â  Â  <div class="modal-content" style="text-align:center">
Â  Â  Â  Â  Â  Â  <h3 data-key="friends_title">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø©</h3>
Â  Â  Â  Â  Â  Â  <div style="background: rgba(0, 152, 234, 0.1); border: 1px dashed var(--primary); padding: 10px; border-radius: 10px; margin-bottom: 15px; font-weight: bold; color: var(--primary);">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ¤ Ø¥Ø­Ø§Ù„Ø§ØªÙƒ Ø§Ù„Ù†Ø§Ø¬Ø­Ø©: <span id="invite-count">0</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <p style="color:#888; font-size:0.9rem;">+5,000 Ù†Ù‚Ø·Ø© Ù„ÙƒÙ„ ØµØ¯ÙŠÙ‚ ÙŠØ¯Ø¹Ùˆ Ù…Ù† Ø±Ø§Ø¨Ø·Ùƒ!</p>
Â  Â  Â  Â  Â  Â  <input type="text" class="inp" id="ref-link-display" readonly>
Â  Â  Â  Â  Â  Â  <button class="btn-main" onclick="copyRef()">Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø¯Ø¹ÙˆØ©</button>
Â  Â  Â  Â  Â  Â  <button class="btn-main" style="background:#222" onclick="closeModal('friendsModal')">Ø¥ØºÙ„Ø§Ù‚</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script type="module">
Â  Â  Â  Â  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
Â  Â  Â  Â  import { getFirestore, doc, getDoc, setDoc, updateDoc, increment, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

Â  Â  Â  Â  const firebaseConfig = {
Â  Â  Â  Â  Â  Â  apiKey: "AIzaSyACixZDVCNww716fRN_29xm2kCnFadkL64",
Â  Â  Â  Â  Â  Â  authDomain: "tele-ea6e7.firebaseapp.com",
Â  Â  Â  Â  Â  Â  projectId: "tele-ea6e7",
Â  Â  Â  Â  Â  Â  storageBucket: "tele-ea6e7.firebasestorage.app",
Â  Â  Â  Â  Â  Â  messagingSenderId: "693110799024",
Â  Â  Â  Â  Â  Â  appId: "1:693110799024:web:4dd4057eef17b9ed3e1975",
Â  Â  Â  Â  Â  Â  measurementId: "G-902LN1FW97"
Â  Â  Â  Â  };

Â  Â  Â  Â  const app = initializeApp(firebaseConfig);
Â  Â  Â  Â  const db = getFirestore(app);
Â  Â  Â  Â  const tg = window.Telegram.WebApp;
Â  Â  Â  Â  tg.expand();

Â  Â  Â  Â  const CONFIG = { adminUsername: "SS34SS4", botLink: "https://t.me/tofe109tofebot" };
Â  Â  Â  Â  let userId = "mustafa_user";
Â  Â  Â  Â  let state = { score: 0, lang: 'ar', completedTasks: [], lastDaily: 0, referredBy: null, inviteCount: 0 };

Â  Â  Â  Â  window.onload = async () => {
Â  Â  Â  Â  Â  Â  if(tg.initDataUnsafe?.user) userId = tg.initDataUnsafe.user.id.toString();
Â  Â  Â  Â  Â  Â  document.getElementById('user-display-name').innerText = tg.initDataUnsafe?.user?.first_name || "Player";

Â  Â  Â  Â  Â  Â  await loadUserData();
Â  Â  Â  Â  Â  Â  await checkReferral(); // Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„ÙÙˆØ±ÙŠ Ù…Ù† Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø­Ø§Ù„Ø©
Â  Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  Â  Â  document.getElementById('loader').style.display = 'none';
Â  Â  Â  Â  };

Â  Â  Â  Â  async function loadUserData() {
Â  Â  Â  Â  Â  Â  const docRef = doc(db, "players", userId);
Â  Â  Â  Â  Â  Â  const snap = await getDoc(docRef);
Â  Â  Â  Â  Â  Â  if(snap.exists()) state = {...state, ...snap.data()};
Â  Â  Â  Â  Â  Â  else await setDoc(docRef, state);
Â  Â  Â  Â  }

Â  Â  Â  Â  async function syncPoints() {
Â  Â  Â  Â  Â  Â  await setDoc(doc(db, "players", userId), state, {merge:true});
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- Ø¥ØµÙ„Ø§Ø­ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø§Ù„Ø© ---
Â  Â  Â  Â  async function checkReferral() {
Â  Â  Â  Â  Â  Â  const param = tg.initDataUnsafe?.start_param;
Â  Â  Â  Â  Â  Â  if(param && param.startsWith('ref_') && !state.referredBy) {
Â  Â  Â  Â  Â  Â  Â  Â  const referrerId = param.split('_')[1];
Â  Â  Â  Â  Â  Â  Â  Â  if(referrerId !== userId) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const refRef = doc(db, "players", referrerId);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ø²ÙŠØ§Ø¯Ø© Ù†Ù‚Ø§Ø· Ù…Ù† Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await updateDoc(refRef, {Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  score: increment(5000),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  inviteCount: increment(1)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ø¥Ø¶Ø§ÙØ© Ù…ÙƒØ§ÙØ£Ø© Ù„Ùƒ (Ø§Ù„Ù…Ø¯Ø¹Ùˆ) ÙˆØªØ«Ø¨ÙŠØª Ø£Ù†Ùƒ Ø¯Ø®Ù„Øª Ø¨Ø±Ø§Ø¨Ø·
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.score += 1000;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  state.referredBy = referrerId;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await syncPoints();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tg.showAlert("Ø±Ø§Ø¦Ø¹! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ù…ÙƒØ§ÙØ£Ø© Ø¯Ø®ÙˆÙ„ 1000 Ù†Ù‚Ø·Ø© ğŸ");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch(e) { console.error("Referral Sync Error", e); }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  window.copyRef = () => {
Â  Â  Â  Â  Â  Â  const link = `${CONFIG.botLink}?start=ref_${userId}`;
Â  Â  Â  Â  Â  Â  navigator.clipboard.writeText(link);
Â  Â  Â  Â  Â  Â  tg.showAlert("ØªÙ… Ø§Ù„Ù†Ø³Ø®! Ø£Ø±Ø³Ù„ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ Ù„Ø±Ø¨Ø­ 5000 Ù†Ù‚Ø·Ø©.");
Â  Â  Â  Â  };

Â  Â  Â  Â  // ... (Ø¨Ø§Ù‚ÙŠ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­ÙØ¸ ÙˆØ§Ù„Ø¶ØºØ· ÙˆØ§Ù„Ù„ØºØ© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªØºÙŠÙŠØ± Ù…Ù†Ø·Ù‚Ùƒ)
Â  Â  Â  Â Â 
Â  Â  Â  Â  window.handleTap = (e) => {
Â  Â  Â  Â  Â  Â  state.score += 1;
Â  Â  Â  Â  Â  Â  updateUI();
Â  Â  Â  Â  Â  Â  if(state.score % 20 === 0) syncPoints();
Â  Â  Â  Â  };

Â  Â  Â  Â  function updateUI() {
Â  Â  Â  Â  Â  Â  document.getElementById('score').innerText = state.score.toLocaleString();
Â  Â  Â  Â  Â  Â  document.getElementById('invite-count').innerText = state.inviteCount || 0;
Â  Â  Â  Â  Â  Â  document.getElementById('ref-link-display').value = `${CONFIG.botLink}?start=ref_${userId}`;
Â  Â  Â  Â  }

Â  Â  Â  Â  window.openModal = (id) => document.getElementById(id).classList.add('active');
Â  Â  Â  Â  window.closeModal = (id) => document.getElementById(id).classList.remove('active');
Â  Â  Â  Â  window.closeAllModals = () => document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));

Â  Â  </script>
</body>
</html>

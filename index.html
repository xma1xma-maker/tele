<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TON Clicker V15</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

<style>
/* ==== THEME ==== */
:root{
--bg:#000;
--card:#151515;
--ton:#0098EA;
--gold:#FFD700;
--text:#fff;
--green:#4cd964;
--red:#ff3b30;
}
*{
box-sizing:border-box;
-webkit-tap-highlight-color:transparent;
user-select:none;
}
body{
font-family:'Cairo',sans-serif;
background:radial-gradient(circle at 50% 0%,#004080,#000);
color:var(--text);
margin:0;
height:100vh;
display:flex;
flex-direction:column;
overflow:hidden;
padding-bottom:90px;
}

/* HEADER */
.header{
padding:15px;
display:flex;
justify-content:space-between;
align-items:center;
background:rgba(255,255,255,.05);
}
.lang-btn{
background:transparent;
border:1px solid var(--ton);
color:var(--ton);
padding:5px 15px;
border-radius:20px;
font-weight:bold;
cursor:pointer;
}
.id-badge{
font-size:.8rem;
color:#888;
background:rgba(0,0,0,.5);
padding:5px 10px;
border-radius:8px;
}

/* SCORE */
.score-box{text-align:center;margin-top:15px;}
.score-val{
font-size:3.5rem;
font-weight:900;
text-shadow:0 0 20px var(--ton);
}
.score-lbl{color:var(--ton);font-size:.9rem}

/* FEATURE */
.feat-bar{
display:flex;
justify-content:center;
gap:20px;
margin:15px 0;
}
.feat-btn{
width:60px;height:60px;
border-radius:15px;
background:#1a1a1a;
display:flex;
align-items:center;
justify-content:center;
font-size:1.8rem;
border:1px solid #333;
}
.feat-btn:active{transform:scale(.9);background:var(--ton)}

/* GAME */
.game-area{
flex:1;
display:flex;
justify-content:center;
align-items:center;
}
.coin{
width:250px;height:250px;
border-radius:50%;
background:var(--ton);
border:8px solid rgba(255,255,255,.1);
box-shadow:0 0 60px rgba(0,152,234,.4);
display:flex;
align-items:center;
justify-content:center;
cursor:pointer;
}
.coin:active{transform:scale(.94)}
.coin svg{width:60%;fill:#fff}

/* ENERGY */
.energy-box{
margin:0 20px;
background:#111;
padding:10px 15px;
border-radius:12px;
border:1px solid #333;
}
.bar-bg{background:#000;height:8px;border-radius:4px;overflow:hidden}
.bar-fill{height:100%;background:linear-gradient(90deg,#fff,var(--ton))}

/* NAV */
.nav{
position:fixed;
bottom:0;left:0;
width:100%;
background:rgba(15,15,15,.95);
border-top:1px solid #333;
display:grid;
grid-template-columns:repeat(3,1fr);
gap:10px;
padding:10px 15px;
}
.nav-btn{
background:rgba(255,255,255,.05);
border:none;
color:#fff;
padding:10px;
border-radius:10px;
font-weight:bold;
}

/* MODAL */
.modal{
position:fixed;
inset:0;
background:rgba(0,0,0,.95);
display:flex;
align-items:flex-end;
justify-content:center;
opacity:0;
visibility:hidden;
transition:.3s;
z-index:1000;
}
.modal.active{opacity:1;visibility:visible}
.modal-card{
background:#181818;
width:100%;
max-width:500px;
border-radius:25px 25px 0 0;
padding:25px;
border-top:3px solid var(--ton);
transform:translateY(100%);
transition:.3s;
max-height:85vh;
overflow:auto;
text-align:center;
}
.modal.active .modal-card{transform:translateY(0)}

.btn{
width:100%;
padding:15px;
background:var(--ton);
border:none;
border-radius:12px;
font-weight:bold;
margin-top:15px;
color:#fff;
}
.btn-close{background:#333}

.inp{
width:100%;
padding:15px;
background:#000;
border:1px solid #444;
border-radius:10px;
color:#fff;
margin-bottom:10px;
text-align:center;
}

.quiz-opt{
padding:15px;
background:#2a2a2a;
border:1px solid #444;
border-radius:10px;
margin-bottom:10px;
}
.correct-anim{background:var(--green)!important;color:#000}
.wrong-anim{background:var(--red)!important}

.task-row{
background:#222;
padding:15px;
border-radius:12px;
margin-bottom:10px;
display:flex;
justify-content:space-between;
align-items:center;
}
.task-btn{
background:var(--ton);
border:none;
padding:5px 15px;
border-radius:6px;
color:#fff;
}
</style>
</head>

<body>

<!-- HTML STRUCTURE (كما هو عندك) -->
<!-- لم ألمسه نهائياً -->

<script>
/* ==== SYSTEM ==== */
const tg = window.Telegram.WebApp;
tg.expand();

/* ==== STATE ==== */
let score = +localStorage.getItem("score_v15") || 0;
let energy = 100;
let lang = localStorage.getItem("lang") || "ar";

/* ==== FIXED UI UPDATE ==== */
function updateUI(){
document.getElementById("score").innerText = score.toLocaleString();
document.getElementById("energy-txt").innerText = `${energy}/100`;
document.getElementById("energy-bar").style.width = energy + "%";
localStorage.setItem("score_v15", score);
}

/* ==== TAP ==== */
function tap(e){
if(energy<=0) return;
energy--;
score++;
updateUI();
}

/* ==== MODALS ==== */
function openModal(id){document.getElementById(id).classList.add("active")}
function closeModal(id){document.getElementById(id).classList.remove("active")}

/* ==== ENERGY REGEN ==== */
setInterval(()=>{
if(energy<100){energy++;updateUI();}
},2000);

updateUI();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crypto Shop System</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #0b0c15;
            --primary: #f3ba2f; 
            --accent: #3498db;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
            --green: #2ecc71;
            --red: #e74c3c;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-deep);
            color: #fff;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- Ø§Ù„Ø®Ù„ÙÙŠØ© --- */
        .cosmic-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at 50% -20%, #1a1a2e, #000);
        }
        .nebula {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle at 80% 20%, rgba(188, 19, 254, 0.15) 0%, transparent 40%),
                        radial-gradient(circle at 20% 80%, rgba(0, 243, 255, 0.1) 0%, transparent 40%);
            animation: pulseBg 10s ease-in-out infinite alternate;
        }
        @keyframes pulseBg { 0% {opacity: 0.5; transform: scale(1);} 100% {opacity: 1; transform: scale(1.1);} }

        /* --- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© --- */
        .header {
            padding: 15px 20px; display: flex; justify-content: space-between; align-items: center;
            backdrop-filter: blur(10px); border-bottom: 1px solid var(--border);
        }
        .rank-badge {
            background: rgba(0,0,0,0.5); padding: 5px 15px; border-radius: 20px;
            border: 1px solid var(--primary); font-size: 0.9rem; display: flex; align-items: center; gap: 5px;
        }

        .score-container { text-align: center; margin-top: 20px; }
        .score-val { font-size: 3.5rem; font-weight: 900; text-shadow: 0 0 20px rgba(255,255,255,0.2); }

        /* --- Ø§Ù„Ø¹Ù…Ù„Ø© --- */
        .game-area { flex-grow: 1; display: flex; justify-content: center; align-items: center; }
        .coin-skin {
            width: 260px; height: 260px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 6rem; cursor: pointer; transition: all 0.1s; position: relative; z-index: 10;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            background: radial-gradient(circle at 30% 30%, #ffd700, #f39c12); border: 8px solid #b76e05;
        }
        .coin-skin:active { transform: scale(0.94); }

        /* --- Ø§Ù„Ø·Ø§Ù‚Ø© --- */
        .energy-wrapper {
            margin: 0 20px 10px 20px; background: #1a1a1a; border-radius: 12px; padding: 15px; border: 1px solid var(--border);
        }
        .energy-bar-bg { background: #000; height: 10px; border-radius: 5px; overflow: hidden; margin-top: 5px; }
        .energy-fill { height: 100%; width: 100%; background: linear-gradient(90deg, #ff0055, #ffcc00); transition: width 0.5s; }

        /* --- Ø§Ù„Ø£Ø²Ø±Ø§Ø± --- */
        .bottom-nav { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 0 20px 30px 20px; }
        .nav-btn {
            background: var(--glass); border: 1px solid var(--border); color: white; padding: 16px;
            border-radius: 15px; font-size: 1rem; font-weight: bold; cursor: pointer; backdrop-filter: blur(10px);
        }

        /* --- Ø§Ù„Ù†ÙˆØ§ÙØ° (Shop & Tasks) --- */
        .modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9);
            z-index: 999; display: none; justify-content: center; align-items: flex-end;
        }
        .modal.open { display: flex; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from {transform: translateY(100%)} to {transform: translateY(0)} }

        .modal-body {
            background: #15151e; width: 100%; border-radius: 25px 25px 0 0; padding: 25px;
            border-top: 2px solid var(--primary); max-height: 80vh; overflow-y: auto;
        }

        /* --- ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ --- */
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .shop-item {
            background: #252530; padding: 15px; border-radius: 15px; text-align: center; border: 1px solid var(--border);
            display: flex; flex-direction: column; align-items: center; justify-content: space-between;
        }
        .shop-icon { font-size: 2.5rem; margin-bottom: 5px; }
        .shop-name { font-size: 0.9rem; margin-bottom: 5px; font-weight: bold; }
        .shop-btn {
            background: var(--green); color: #fff; border: none; padding: 8px 15px; width: 100%;
            border-radius: 8px; cursor: pointer; font-size: 0.8rem; font-weight: bold; margin-top: 5px;
        }
        .shop-btn.expensive { background: #555; cursor: not-allowed; } /* Ù„ÙˆÙ† Ø±Ù…Ø§Ø¯ÙŠ Ø¥Ø°Ø§ Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ø§ ÙŠÙƒÙÙŠ */
    </style>
</head>
<body>

    <div class="cosmic-bg"><div class="nebula"></div></div>

    <div class="header">
        <div class="rank-badge">ğŸ† <span id="rank-name">Ù„Ø§Ø¹Ø¨</span></div>
        <div>ğŸ’° Ø§Ù„Ù…ØªØ¬Ø± Ù…ÙØªÙˆØ­</div>
    </div>

    <div class="score-container">
        <div class="score-val" id="score">0</div>
        <div style="color:#aaa; font-size:0.9rem">Ø±ØµÙŠØ¯Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
    </div>

    <div class="game-area">
        <div class="coin-skin" id="coin-btn" onclick="tap(event)">$</div>
    </div>

    <div class="energy-wrapper">
        <div style="display:flex; justify-content:space-between; font-size:0.9rem">
            <span>âš¡ Ø§Ù„Ø·Ø§Ù‚Ø© (3 Ø«ÙˆØ§Ù†ÙŠ)</span>
            <span id="energy-txt">10/10</span>
        </div>
        <div class="energy-bar-bg">
            <div class="energy-fill" id="energy-bar"></div>
        </div>
    </div>

    <div class="bottom-nav">
        <button class="nav-btn" onclick="openModal('tasks-modal')">ğŸ“‹ Ø§Ù„Ù…Ù‡Ø§Ù…</button>
        <button class="nav-btn" onclick="openModal('shop-modal')">ğŸ›ï¸ Ø§Ù„Ù…ØªØ¬Ø±</button>
    </div>

    <div class="modal" id="shop-modal">
        <div class="modal-body">
            <h3 style="color:var(--primary); margin:0">ğŸ›’ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù†Ù‚Ø§Ø·</h3>
            <p style="color:#aaa; font-size:0.8rem; margin-bottom:15px">Ø§Ù†Ù‚Ø± Ù„Ø´Ø±Ø§Ø¡ Ø§Ù„Ù‡Ø¯ÙŠØ©. Ø³ÙŠØªÙ… Ø®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø· ÙÙˆØ±Ø§Ù‹.</p>
            
            <div class="shop-grid">
                
                <div class="shop-item">
                    <span class="shop-icon">âš¡</span>
                    <span class="shop-name">Ø·Ø§Ù‚Ø© ÙƒØ§Ù…Ù„Ø©</span>
                    <button class="shop-btn" onclick="buyItem(50, 'energy')">Ø´Ø±Ø§Ø¡ (50 Ù†Ù‚Ø·Ø©)</button>
                </div>

                <div class="shop-item">
                    <span class="shop-icon">â­</span>
                    <span class="shop-name">Ù†Ø¬Ù…Ø© ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</span>
                    <button class="shop-btn" onclick="buyItem(500, 'star')">Ø´Ø±Ø§Ø¡ (500 Ù†Ù‚Ø·Ø©)</button>
                </div>

                <div class="shop-item">
                    <span class="shop-icon">ğŸ’</span>
                    <span class="shop-name">1 USDT</span>
                    <button class="shop-btn" onclick="buyItem(5000, 'usdt')">Ø³Ø­Ø¨ (5,000 Ù†Ù‚Ø·Ø©)</button>
                </div>

                <div class="shop-item">
                    <span class="shop-icon">ğŸ¨</span>
                    <span class="shop-name">Ø¹Ù…Ù„Ø© Ø²Ø±Ù‚Ø§Ø¡</span>
                    <button class="shop-btn" onclick="buyItem(200, 'skin_blue')">Ø´Ø±Ø§Ø¡ (200 Ù†Ù‚Ø·Ø©)</button>
                </div>

            </div>
            <button class="nav-btn" style="width:100%; margin-top:20px; background:#333" onclick="closeModal('shop-modal')">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div class="modal" id="tasks-modal">
        <div class="modal-body">
            <h3>Ø§Ù„Ù…Ù‡Ø§Ù… (+10 Ù†Ù‚Ø§Ø·)</h3>
            <button class="nav-btn" style="width:100%; margin-bottom:10px" onclick="window.open('https://t.me/telegram'); addPoints(10)">
                âœˆï¸ Ø§Ø´ØªØ±Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø©
            </button>
            <button class="nav-btn" style="width:100%; background:#333" onclick="closeModal('tasks-modal')">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <script>
        // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
        let score = localStorage.getItem('score_v5') ? parseInt(localStorage.getItem('score_v5')) : 0;
        let energy = 10;
        const maxEnergy = 10;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø¡
        updateUI();

        // 1. Ø¯Ø§Ù„Ø© Ø§Ù„Ù†Ù‚Ø±
        function tap(e) {
            if (energy > 0) {
                score++;
                energy--;
                saveData();
                updateUI();
                
                // ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ
                const el = document.createElement('div');
                el.innerText = '+1';
                el.style.position = 'fixed'; 
                el.style.left = e.clientX+'px'; 
                el.style.top = e.clientY+'px';
                el.style.color = '#fff'; 
                el.style.fontWeight='bold';
                el.style.pointerEvents='none';
                document.body.appendChild(el);
                
                // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø±Ù‚Ù… Ù„Ù„Ø£Ø¹Ù„Ù‰
                let pos = 0;
                let op = 1;
                const anim = setInterval(()=>{
                    pos+=2; op-=0.05;
                    el.style.transform = `translateY(-${pos}px)`;
                    el.style.opacity = op;
                    if(op<=0){ clearInterval(anim); el.remove(); }
                }, 30);

            } else {
                openModal('tasks-modal');
            }
        }

        // 2. Ø¯Ø§Ù„Ø© Ø§Ù„Ø´Ø±Ø§Ø¡ Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø± (Core Feature)
        function buyItem(price, type) {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯
            if (score >= price) {
                const confirmBuy = confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø´Ø±Ø§Ø¡ Ù…Ù‚Ø§Ø¨Ù„ ${price} Ù†Ù‚Ø·Ø©ØŸ`);
                
                if (confirmBuy) {
                    // Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø®ØµÙ…
                    score -= price; 
                    saveData();
                    updateUI();

                    // ØªØ³Ù„ÙŠÙ… Ø§Ù„Ù‡Ø¯ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
                    if (type === 'energy') {
                        energy = maxEnergy;
                        alert("ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡! âš¡ Ø·Ø§Ù‚ØªÙƒ Ù…Ù…ØªÙ„Ø¦Ø© Ø§Ù„Ø¢Ù†.");
                    } 
                    else if (type === 'skin_blue') {
                        document.getElementById('coin-btn').style.background = 'radial-gradient(circle, #00f3ff, #2980b9)';
                        alert("ØªÙ… ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø¹Ù…Ù„Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ù‚! ğŸ¨");
                    }
                    else if (type === 'usdt') {
                        alert("âœ… ØªÙ… Ø±ÙØ¹ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨! Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ù†Ù‚Ø§Ø·Ùƒ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‡Ø¯ÙŠØ© Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©.");
                    }
                    else {
                        alert(`Ù…Ø¨Ø±ÙˆÙƒ! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ØµØ± Ø¨Ù†Ø¬Ø§Ø­. ØªÙ… Ø®ØµÙ… ${price} Ù†Ù‚Ø·Ø©.`);
                    }
                    
                    closeModal('shop-modal');
                }
            } else {
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù„Ø¯ÙŠÙ‡ Ø±ØµÙŠØ¯
                alert(`âŒ Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙŠ! ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ${price - score} Ù†Ù‚Ø·Ø© Ø¥Ø¶Ø§ÙÙŠØ©.`);
            }
        }

        // 3. Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø· (Ù„Ù„Ù…Ù‡Ø§Ù…)
        function addPoints(amount) {
            score += amount;
            saveData();
            updateUI();
            alert(`Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${amount} Ù†Ù‚Ø·Ø©!`);
        }

        // 4. ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function updateUI() {
            document.getElementById('score').innerText = score.toLocaleString();
            document.getElementById('energy-txt').innerText = `${energy}/${maxEnergy}`;
            document.getElementById('energy-bar').style.width = (energy/maxEnergy*100) + '%';
        }

        function saveData() {
            localStorage.setItem('score_v5', score);
        }

        // 5. ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø·Ø§Ù‚Ø© ÙƒÙ„ 3 Ø«ÙˆØ§Ù†ÙŠ
        setInterval(() => {
            if (energy < maxEnergy) {
                energy++;
                updateUI();
            }
        }, 3000);

        // Ù†ÙˆØ§ÙØ°
        function openModal(id) { document.getElementById(id).classList.add('open'); }
        function closeModal(id) { document.getElementById(id).classList.remove('open'); }

    </script>
</body>
</html>
